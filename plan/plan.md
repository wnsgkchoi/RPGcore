## 1. RPGCore+ 경제 및 재화 시스템 상세 요약 (XP 단일 화폐 기반)
### 1. 기본 재화 정책

* **단일 화폐 사용:** 마인크래프트 바닐라 XP (`player.getTotalExperience()`로 접근하는 누적 총 경험치, 이하 "Raw XP")를 플러그인의 유일한 핵심 재화로 사용합니다. 별도의 '골드'나 다른 게임 내 화폐는 도입하지 않습니다.
* **바닐라 레벨의 역할:** 마인크래프트 플레이어 레벨 표시는 바닐라 도구(곡괭이, 도끼 등)의 인챈트에만 사용됩니다. RPGCore+ 플러그인의 모든 XP 소모 및 보상 계산은 Raw XP를 기준으로 합니다.

### 2. XP 획득처 (XP Sources)

* **기본 획득 경로:**
    * **바닐라 활동:** 몬스터 사냥, 광물 채광, 낚시, 농사, 제련, 동물 교배 등 기존 마인크래프트에서 XP를 제공하는 모든 활동을 통해 XP를 획득할 수 있습니다.
    * **RPGCore+ 커스텀 몬스터 사냥:** 플러그인에서 추가하는 커스텀 몬스터를 사냥하여 XP를 획득합니다.
* **XP 획득량 증가 스탯:**
    * 플레이어의 기본 스탯 중 **"XP 획득량 증가"** 스탯이 존재합니다.
    * 이 스탯의 수치가 높을수록 **커스텀 몬스터 사냥 시** 획득하는 XP의 양이 증가합니다. (바닐라 활동으로 얻는 XP에는 직접적인 영향을 주지 않음. 단, 추후 다른 RPGCore+ 활동 보상에 이 스탯이 영향을 미칠지는 추가 논의 가능)
    * (구체적인 스탯 효율 및 스케일링은 "커스텀 스탯 시스템" 설계 시 상세화 예정)

### 3. XP 소모처 (XP Sinks)

* **바닐라 도구 인챈트:**
    * 플레이어 레벨을 사용하여 바닐라 인챈트 테이블에서 도구류 아이템을 인챈트합니다. (RPGCore+ 커스텀 무기 및 방어구는 바닐라 인챈트 금지)
* **커스텀 장비 제작:**
    * 각 커스텀 장비의 제작 레시피마다 개별적으로 설정된 Raw XP를 소모합니다. (레시피 설정 파일에 XP 비용 명시)
* **커스텀 장비 강화:**
    * 강화하려는 커스텀 장비의 종류 및 현재 강화 단계(레벨)에 따라 개별적으로 설정된 Raw XP를 소모합니다. (장비별/강화 레벨별 XP 비용 테이블 또는 공식 필요)
* **스킬 강화:**
    * 강화하려는 스킬의 종류 및 현재 스킬 레벨에 따라 개별적으로 설정된 Raw XP를 소모합니다. (스킬별/레벨별 XP 비용 테이블 또는 공식 필요)
* **스킬 습득:**
    * 새로운 스킬을 처음 배울 때는 **XP를 소모하지 않습니다.** (스킬 해금은 주로 클래스 레벨, 플레이어 레벨 또는 선행 조건 달성 등을 통해 이루어질 것으로 예상)
* **스탯 강화:**
    * 플레이어가 특정 스탯을 증가시킬 때 즉시 Raw XP가 차감됩니다.
    * XP 소모량은 해당 스탯을 이미 강화한 횟수(즉, 해당 스탯의 현재 포인트)에 따라 증가하며, 구체적인 비용 계산 방식은 `min(선형 함수 값, 로그 함수 값)`을 따릅니다.
        * **선형 함수:** 초기 스탯 강화 시 적용되며, 꾸준히 비용이 증가합니다.
        * **로그 함수:** 상대적으로 큰 계수를 가지며, 스탯 수치가 매우 높아졌을 때 선형 함수보다 낮은 비용을 제공하여 극단적인 비용 증가를 막고 후반부 스탯 투자 부담을 완화합니다.
        * (정확한 선형/로그 함수식, 계수, 전환 지점 등은 "커스텀 스탯 시스템" 설계 시 상세화 예정)

### 4. 밸런싱 철학

* **서버 운영 기간:** 장기적인 운영을 목표로 하지 않으므로, 비교적 짧은 기간 내에 플레이어가 다양한 콘텐츠를 경험하고 성장할 수 있도록 설계합니다.
* **XP 획득 난이도:** 플레이어가 XP를 **비교적 쉽게** 얻을 수 있도록 하여, 다양한 XP 소모처에 적극적으로 활용할 수 있도록 유도합니다.
* **세부 수치 조정:** 전반적인 XP 획득량, 각 콘텐츠별 소모량 등의 구체적인 수치는 서버 실제 운영 및 테스트를 통해 유동적으로 조정해나갈 예정입니다.

### 5. XP 거래 및 손실 정책

* **사망 시 XP 손실:**
    * 서버 설정에서 `keepInventory = true`를 적용하여, 플레이어 사망 시 아이템뿐만 아니라 XP도 손실되지 않도록 합니다.
* **플레이어 간 XP 거래:**
    * XP의 플레이어 간 거래를 **허용**합니다.
    * 이를 위해 커스텀 **거래 GUI**를 개발합니다.
    * **거래 방식:**
        1.  플레이어는 거래 GUI 내의 특정 버튼을 클릭합니다.
        2.  채팅창에 상대방에게 전달하고자 하는 Raw XP의 양을 입력합니다.
        3.  입력된 XP 양이 거래 창에 아이템과 함께 "첨부된 XP"로 표시됩니다.
        4.  양측 플레이어가 거래 내용을 확인하고 수락하면 아이템과 함께 첨부된 XP가 상대방에게 이전됩니다.

### 6. UI/UX (사용자 인터페이스/경험) 관련

* **현재 보유 XP 표시:**
    * 플레이어는 자신의 현재 총 보유 Raw XP를 화면의 **사이드바**를 통해 실시간으로 확인할 수 있습니다. (사이드바의 구체적인 디자인 및 기타 표시 정보는 "유저 인터페이스 시스템" 설계 시 상세화 예정)
* **XP 소모 시점의 UX:**
    * 모든 GUI 기반의 XP 소모 활동(커스텀 장비 제작, 강화, 스탯 강화 등)에서, 플레이어가 해당 작업을 실행하는 슬롯(또는 버튼)을 **우클릭**하면 즉시 XP가 소모되고 작업이 실행됩니다.
    * 이 과정에서 별도의 **경고 메시지나 "정말 사용하시겠습니까?"와 같은 확인 절차는 제공하지 않습니다.** (플레이어의 신속한 조작을 우선시하며, XP 획득이 비교적 쉬운 점으로 리스크를 일부 상쇄)


## 2. RPGCore+ 커스텀 스탯 시스템 상세 요약
### 1. 기본 철학 및 구조

* **직관적인 스탯:** 플레이어는 '힘', '민첩' 같은 추상적인 기본 스탯 대신 '공격력', '최대 HP' 등 최종적으로 적용되는 형태의 스탯을 직접 강화합니다. 즉, XP로 성장시키는 스탯의 종류가 최종 스탯의 종류와 일치합니다.
* **스탯 분류:**
    * **XP로 강화 가능한 스탯 (기본 성장 스탯):** 플레이어가 XP를 소모하여 직접 수치를 올릴 수 있는 스탯입니다.
    * **XP로 강화가 불가능한 스탯:** 주로 장비, 스킬, 버프, 몬스터 도감 등을 통해 획득하는 스탯입니다.

### 2. 스탯의 종류 및 초기값

* **XP로 강화 가능한 스탯 (초기값):**
    1.  `HP (최대 HP)`: 20
    2.  `MP (최대 MP)`: 50
    3.  `공격력 (Attack Power)`: 5
    4.  `방어력 (Defense Power)`: 5
    5.  `주문력 (Spell Power / Ability Power)`: 5
    6.  `마법저항력 (Magical Resistance)`: 5
* **XP로 강화가 불가능한 스탯 (초기값):**
    1.  `공격속도 (Attack Speed)`: 1 (배율)
    2.  `치명타 확률 (%)`: 0%
    3.  `쿨타임 감소율 (%)`: 0%
    4.  `물리 흡혈 (%)`: 0%
    5.  `주문 흡혈 (%)`: 0%
    6.  `경험치 획득량 증가율 (%)`: 0% (장비/버프/도감 등으로만 획득)
    7.  `아이템 드롭율 증가율 (%)`: 0%

### 3. 스탯 강화 비용 (XP 소모)

* **대상 스탯:** XP로 강화 가능한 스탯 (HP, MP, 공격력, 방어력, 주문력, 마법저항력).
* **비용 계산 원칙:** 해당 스탯을 이미 강화한 횟수(현재 투자된 포인트)에 비례하여 증가하며, `min(선형 함수 값, 로그 함수 값)` 공식을 따릅니다.
    * 선형 함수: 초기 비용 증가를 담당.
    * 로그 함수: 후반부 극단적인 비용 증가를 완화 (큰 계수 적용).
* **구체적인 함수식 및 파라미터:** 플러그인 전체 시스템 설계 후, 종합적인 밸런싱 단계에서 결정 예정입니다.

### 4. 최종 스탯 계산 공식

* **A. XP 강화 가능 스탯 (HP, MP, 공격력, 방어력, 주문력, 마법저항력)의 경우:**
    `최종 스탯 = ((기본 성장 스탯) + (개별 장비 추가 스탯) + (세트 장비 추가 스탯) + (버프/디버프 추가 스탯)) * (개별 장비 배율 스탯) * (세트 장비 배율 스탯) * (버프/디버프 배율 스탯) * (몬스터 도감 보너스 배율 스탯)`
    * `(기본 성장 스탯)`: 플레이어가 XP로 올린 순수 스탯 값.
    * 각 `추가 스탯`은 고정 수치 합산, 각 `배율 스탯`은 %를 소수로 변환하여 곱산 (예: 10%면 1.1 또는 0.1을 상황에 맞게 적용).
    * `(몬스터 도감 보너스 배율 스탯)`: 몬스터 도감 완성도를 통해 이 스탯들에 적용되는 전체적인 곱연산자.
* **B. 특정 비율 기반 스탯 (치명타 확률, 쿨타임 감소율, 물리/주문 흡혈, 경험치/아이템 드롭율 증가율)의 경우:**
    `최종 % 스탯 = (플레이어 기본 제공 % 값; 대부분 0%) + (모든 장비에서 제공하는 % 총합) + (모든 버프/디버프에서 제공하는 % 총합) + (몬스터 도감에서 제공하는 % 보너스 총합)`
    * 이 스탯들은 곱연산 없이 순수하게 합연산으로만 계산됩니다.
* **C. 공격속도 스탯의 경우 (예외적 계산):**
    `실제 공격 딜레이(ms) = 무기 기본 cooldownMs / 플레이어의 "공격속도" 스탯 값`
    * 플레이어의 "공격속도" 스탯(초기값 1) 자체는 장비, 버프 등에서 얻는 수치들의 합으로 계산될 수 있습니다. 무기의 `cooldownMs`는 각 무기별로 주어지는 고유 값입니다.
* **음수 방지:** 모든 최종 스탯 값은 음수가 되지 않도록 최소값(일반적으로 0, HP는 1 등) 처리가 필요합니다.

### 5. 주요 스탯 상세 설명

* **공격력:** 단일 통합 스탯. 모든 클래스의 일반 공격(기본 공격) 데미지에 관여.
* **주문력:** 일부 스킬의 계수로 사용됨. 마법사 계열 클래스의 핵심 스탯. 특정 패시브 스킬을 통해 일반 공격에 주문력 계수가 추가될 수 있으나, 기본적으로는 일반 공격에 직접 관여하지 않음.
* **몬스터 도감 보너스:**
    * XP 강화 가능 스탯에는 전체적인 **곱연산 배율**로 기여.
    * 비율 기반 스탯(XP 강화 불가능 스탯 중 %)에는 각 몬스터 완료 시 **합연산 방식의 +n% 포인트**를 제공. 주로 XP로 강화할 수 없는 스탯들의 성장 경로로 활용.
* **경험치 획득량 증가율(%):** XP로 직접 강화 불가능. 오직 장비, 버프, 몬스터 도감 등을 통해서만 획득 가능.

### 6. 스탯의 최대치 (Caps)

* 플러그인 코드상으로 각 스탯에 대한 **하드코딩된 최대 상한선은 설정하지 않습니다.**
* 실질적인 스탯 한계는 장비, 스킬, 버프 등의 전체적인 게임 밸런스를 통해 자연스럽게 형성되도록 유도합니다.

### 7. 스탯 GUI (내용 및 기본 상호작용)

* **GUI 종류:** 인벤토리 기반 GUI.
* **통합 인터페이스:** 스탯 정보 확인과 XP를 사용한 스탯 강화가 동일한 GUI 내에서 이루어집니다.
* **섹션 구분:**
    * 첫 번째 줄: XP로 강화 가능한 스탯.
    * 두 번째 줄: XP로 강화 불가능한 스탯.
    * 각 줄의 첫 번째 슬롯에 "이름표가 붙은 유리판"을 사용하여 섹션 제목 명시 (예: "성장 스탯 (우클릭 강화)", "부가 능력치").
* **스탯 아이콘:** 각 스탯마다 고유 색상을 부여하고, 해당 색상의 양털 또는 유리판 등을 아이콘으로 사용.
* **표시 정보 (Lore) - XP 강화 가능 스탯:**
    1.  스탯 이름
    2.  간단한 설명
    3.  `현재 base 스탯` (XP로 올린 값) - *강조 색상 1*
    4.  세부 증가분: 장비(`+n, *n%`), 세트(`+n, *n%`), 버프/디버프(`+n, *n%`), 도감(`*n%` 배율)
    5.  `최종 스탯 값` - *강조 색상 1*
    6.  강화 정보: `강화 후 base 스탯 / 최종 스탯 예측` - *강조 색상 2*, `강화 필요 XP`, "우클릭으로 강화" 문구.
* **표시 정보 (Lore) - XP 강화 불가능 스탯:**
    1.  스탯 이름
    2.  간단한 설명
    3.  세부 증가분: 장비(`+X%`), 버프/디버프(`+Y%`), 도감(`+Z%`) (공격속도는 최종 배율값)
    4.  `최종 스탯 값` - *강조 색상 1*
* **강화 실행:** XP 강화 가능한 스탯 아이콘 우클릭 시, 별도의 확인 절차 없이 즉시 XP 소모 및 스탯 강화.
* **빈 슬롯:** 향후 스탯 추가를 위해 비워둠. GUI는 ESC 키로 닫음. 총 보유 XP는 사이드바(스코어보드)로 확인.
* **정보 우선순위:** Lore 내 중요 정보(base 스탯, final 스탯, 강화 후 final 스탯 등)는 다른 색상으로 강조.

## 3. RPGCore+ 클래스 시스템 상세 요약
### 1. 클래스 시스템 기본 철학 및 구조
* **클래스 계열:** 총 4가지 주요 계열 (전사, 암살자, 원거리 딜러, 마법사)을 중심으로 하며, 각 계열 내에 하나 이상의 구체적인 클래스가 존재합니다.
* **상위 클래스:** 전직 또는 각성과 같은 상위 클래스 시스템은 도입하지 않습니다.
* **클래스 레벨:** 클래스 고유의 레벨업 시스템은 없습니다. 플레이어의 성장은 주로 스탯 강화(XP 소모), 스킬 강화(XP 소모), 장비 등을 통해 이루어집니다.
* **직업 고유 능력:** 각 클래스는 하나 이상의 고유한 메커니즘 또는 지속 효과(패시브)를 가지며, 이는 플레이어가 별도로 장착하지 않아도 해당 클래스에게 기본적으로 부여됩니다. (내부적으로는 스킬처럼 관리)
* **장착 스킬 시스템:**
    * 플레이어는 각 클래스별로 준비된 더 큰 스킬 풀(라이브러리)에서 스킬을 선택하여 장착합니다.
    * 장착 슬롯: **액티브 스킬 3개, 패시브 스킬 3개.**
    * 스킬 교체: 자유롭게 가능 (조건 미정).

### 2. 액티브 스킬 글로벌 키 바인딩

* **일반 공격 (기본 공격):**
    * **좌클릭:** "원거리 딜러" 중 바닐라 활/석궁을 사용하는 클래스를 제외한 모든 클래스의 주력 기본 공격.
    * **우클릭:** "원거리 딜러" 중 바닐라 활/석궁을 사용하는 클래스의 주력 기본 공격. (이 경우 해당 클래스의 좌클릭은 데미지가 없거나 매우 낮게 설정됨). 다른 클래스에게 우클릭은 현재 특정 행동이 지정되지 않음 (향후 커스텀 무기 보조 발사 등으로 활용 가능).
* **액티브 스킬 발동:**
    * **Q키:** 액티브 스킬 1 (아이템 버리기 이벤트 취소 후 발동).
    * **F키:** 액티브 스킬 2 (아이템 양손 바꾸기 이벤트 활용, Mainhand에 무기 소지 조건).
    * **Shift + Q키:** 액티브 스킬 3 (아이템 버리기 이벤트 + 웅크리기 상태 확인).

### 3. 클래스 선택 및 변경 GUI

* **접근:** `/class` 명령어를 통해 인벤토리 기반 GUI 오픈.
* **GUI 크기 및 레이아웃:** 4x9 (36칸). 4개의 각 줄은 클래스 계열(전사, 암살자, 원거리 딜러, 마법사)을 대표하며, 각 줄의 첫 번째 슬롯에는 해당 계열을 설명하는 아이템이 배치됩니다. 그 옆 슬롯들에는 해당 계열에 속하는 실제 클래스를 선택할 수 있는 아이콘들이 나열됩니다.
* **클래스 아이콘 정보 (Lore):** 클래스 이름, 속한 계열, 간략한 컨셉 설명, 핵심 고유 메커니즘 요약, 주요 역할, 변경 비용 등이 표시됩니다.
* **선택 및 변경 방식:**
    * 최초 클래스 선택: 무료. (관리자가 신규 플레이어에게 직접 GUI를 열어 안내)
    * 이후 클래스 변경: 300,000 XP 소모.
    * 상호작용: 클래스 아이콘 클릭 시 (XP 충분하면) **별도의 확인 절차 없이 즉시 클래스가 변경**되고 XP가 차감됩니다.

### 4. 현재까지 구상된 클래스별 핵심 컨셉 및 고유 메커니즘

**(A) 전사 (Warrior) 계열**

1.  **가칭: 가시 탱커 / 반사 전사 (Thorns Tank)**
    * **핵심 컨셉:** 높은 생존력, 받은 피해와 자신의 `주문력`에 비례하는 반사 데미지.
    * **고유 메커니즘 (직업 고유 능력):** 지속적인 반사 데미지 오라 또는 피격 시 반사.
    * **주요 스탯:** HP, 방어력, 마법저항력, (보조) 주문력, (일부 스킬용) 공격력.
    * **자원:** MP (장착 스킬용).
2.  **가칭: 광전사 / 전투광 딜러 (Frenzy DPS)**
    * **핵심 컨셉:** 전투 중 피해를 주거나 받으면 "전투 열기" 스택 획득, 스택에 비례하여 공격력 및 공격 속도 극대화.
    * **고유 메커니즘 (직업 고유 능력 - "전투 열기 스택"):**
        * 최대 50 스택, 타격/피격 시 1 스택씩 획득.
        * 50 스택 효과: 공격력 +200% (총 3배), 공격속도 스탯 +1.0 (실질 공속 2배). (1스택당 공격력 +4%, 10스택당 공격속도 +0.2)
        * 비전투 시 2초당 1 스택 감소. 최대 스택 증가 불가.
    * **주요 스탯:** 공격력, HP. MP (장착 스킬용).

**(B) 암살자 (Assassin) 계열**

1.  **가칭: 질풍검객 / 바람의 칼날 (Gale Striker)**
    * **핵심 컨셉:** 모든 스킬에 이동 요소 결합, 매우 빠른 기동성을 바탕으로 한 단일 대상 연속 공격 및 폭딜.
    * **고유 메커니즘 (직업 고유 능력 - "끊임없는 칼바람"):**
        * **1단계 (잔영 축적, 스택 1~4):** 스킬 적중 시 스택 획득. 3초 내 추가 스킬 미적중 시 스택 초기화.
        * **2단계 (질풍노도, 스택 5~25):** 5스택 도달 시 진입. 동일하게 3초 룰 적용. 최대 25스택.
        * **질풍노도 효과 (스택 비례, 5스택 단위 계수 변화):** 모든 치명타 공격 강화 (방어력 추가 무시 + 최종 데미지 증폭 배율 증가), 스킬 쿨타임 감소.
    * **주요 스탯:** 공격력, 쿨타임 감소율, 치명타 확률, MP.

**(C) 원거리 딜러 (Ranged Dealer) 계열** (현재 "명사수" 1종 우선 구상)

1.  **명사수 (Marksman)**
    * **핵심 컨셉:** 정밀 저격, 강력한 단일 대상 차징샷. 낮은 생존성, 안전거리 확보 시 높은 DPM.
    * **고유 메커니즘 (직업 고유 능력 - "정밀 차징 샷"):**
        * 단계별 차징 (차징 중 이동 불가, 단계별 알림음).
        * 차징 효과: 특정 단계부터 무중력 화살, 최종 단계 시 `치명타 확률 +100%`, 100% 초과 치명타 확률은 최종 데미지 % 증폭으로 전환.
    * **주요 약점 보완:** 다수의 적에게 취약한 점은 장착형 스킬로 보완 예정.
    * **무기:** 바닐라 활/석궁 (우클릭 평타) 또는 커스텀 저격총 (좌클릭 평타).
    * **주요 스탯:** 공격력, 치명타 확률. MP (장착 스킬용).

**(D) 마법사 (Mage) 계열** (현재 "원소술사" 1종 우선 구상)

1.  **원소술사 (Elementalist)**
    * **핵심 컨셉:** 약한 기본 공격, 스킬 사용 비중 매우 높음. 냉기(프리징), 뇌격(패럴라이징), 화염(버닝)의 3가지 원소 스택 활용.
    * **고유 메커니즘 1 (강제 스킬 구성):** 3개의 액티브 스킬 슬롯에 반드시 냉기, 뇌격, 화염 속성 스킬을 각각 하나씩 장착.
    * **고유 메커니즘 2 (영구 원소 스택):**
        * 각 원소 스킬은 대상에게 영구적인(익스플로전으로 소모 전까지) 해당 원소 스택(최대 1개) 부여. (개별 스킬 데미지는 낮음)
        * 프리징 스택: 이동 속도 감소.
        * 패럴라이징 스택: 대상의 최종 데미지 감소.
        * 버닝 스택: 부여 + 원소술사 주변 7~10칸 내 버닝 스택 대상 수 비례 `주문력` 증가 (몬스터당 +5%, 상한선 없음).
    * **고유 메커니즘 3 (엘리멘탈 익스플로전):**
        * 한 대상에게 3가지 원소 스택이 모두 쌓이면 자동 발동.
        * 매우 강력한 `주문력` 비례 피해 (버닝 스택으로 증가된 주문력도 반영).
        * 발동 후 해당 대상의 모든 원소 스택 소모.
    * **주요 스탯:** 주문력, MP, 쿨타임 감소율.

**참고:** 각 클래스가 선택하여 장착할 수 있는 구체적인 액티브/패시브 스킬들의 전체 라이브러리는 아직 상세히 설계되지 않았으며, 이는 "커스텀 스킬 시스템"에서 다룰 예정입니다.

## 4. RPGCore+ 커스텀 스킬 시스템 상세 요약
### 1. 스킬 시스템 기본 철학 및 구조

* **스킬 구성:** 플레이어는 **액티브 스킬 3개**와 **패시브 스킬 3개**를 선택하여 장착합니다.
* **직업 고유 능력:** 각 클래스는 위 6개의 장착 스킬과 별개로, 하나 이상의 고유 메커니즘 또는 지속 효과(패시브)를 가집니다. 이 고유 능력들은 내부적으로 스킬처럼 관리되나 플레이어가 직접 장착/해제하지 않습니다. (플레이어는 실질적으로 `6 + α`개의 스킬 효과를 가짐)
* **스킬 습득:**
    * 모든 스킬이 처음부터 주어지는 것이 아니며, 주로 **특정 몬스터 처치 시 낮은 확률로 스킬(또는 스킬북)을 직접 획득**하는 방식으로 이루어집니다.
    * 최초 클래스 선택 시에는 기본적인 (성능이 높지 않은) 액티브/패시브 스킬이 각각 3개씩 지급될 수 있습니다.
    * 스킬에는 암묵적인 "티어" 또는 성능 차이가 존재하여, 상위 호환 스킬이나 더 강력한 스킬이 존재할 수 있습니다. (명시적인 `tier` 필드는 YAML에 없음)
* **스킬 레벨업:**
    * 습득한 스킬은 XP를 소모하여 레벨을 올릴 수 있습니다.
    * 레벨업 비용은 오직 **XP**만 사용되며, 각 스킬의 각 레벨마다 YAML에 개별적으로 정의됩니다.
* **확장성 및 유지보수:** 향후 스킬 추가 및 수정이 용이하도록 YAML 기반으로 데이터를 관리하며, 서버 실행 중 스킬 설정 리로드 기능을 목표로 합니다.

### 2. 스킬 데이터 정의 (YAML 파일)

* **파일 구조:** 플러그인 데이터 폴더 내 `skills` 폴더에, **하나의 YAML 파일당 하나의 스킬**을 정의하는 방식을 고려합니다. (예: `skills/fireball.yml`) 각 파일 내에 `class_restrictions`를 명시합니다.
* **주요 YAML 속성 (스킬별):**
    * `internal_id` (또는 파일명 자체가 ID 역할)
    * `display_name`: 게임 내 표시 이름 (색상 코드 지원)
    * `description`: 스킬 설명 (여러 줄 Lore 형태)
    * `icon`: GUI 대표 아이콘 (`material`, `custom_model_data` 등)
    * `skill_type`: `ACTIVE` 또는 `PASSIVE`
    * `behavior`: `INSTANT`, `DURATION_BASED`, `CHANNELING`, `TOGGLE` (스킬 작동 방식)
    * `element`: `NONE`, `FIRE`, `ICE`, `LIGHTNING` 등 (주로 원소술사 등 특정 클래스 스킬에 사용)
    * `target_selector`: `SELF`, `SINGLE_ENTITY`, `AREA_OF_EFFECT` (세부 옵션: `aoe_shape`, `aoe_radius`), `POINT_LOCATION` 등
    * `cast_location`: (범위기일 경우) `CASTER_POSITION`, `PROJECTILE_IMPACT`, `TARGET_LOCATION` 등
    * `max_level`: 스킬의 최대 레벨
    * `is_interruptible_by_damage`: `true/false` (채널링/시전 중 피격 시 중단 여부)
    * `interrupt_on_move`: `true/false` (채널링/시전 중 이동 시 중단 여부)
    * `class_restrictions`: `["class_id_1", "class_id_2"]` (사용 가능 클래스 목록)
* **레벨별 상세 설정 (`levels` 하위 섹션):**
    * 각 레벨(1, 2, ... `max_level`)마다 다음 항목들을 개별적으로 정의:
        * `mp_cost`: 해당 레벨의 MP 소모량 (고정값)
        * `cooldown_ticks`: 해당 레벨의 쿨타임 (틱 단위, 고정값)
        * `cast_time_ticks`: 해당 레벨의 시전 시간 (틱 단위, 고정값)
        * `duration_ticks`: (지속 스킬의 경우) 해당 레벨의 지속 시간 (틱 단위, 고정값)
        * `effects`: 해당 레벨에서 발동되는 효과 목록 (아래 참조)
* **스킬 효과 정의 (`effects` 목록 내부):**
    * 각 효과는 `type`을 가집니다 (예: `DAMAGE`, `HEAL`, `MODIFY_ATTRIBUTE`, `APPLY_CUSTOM_STATUS`, `SPAWN_PARTICLE`, `PLAY_SOUND` 등).
    * **데미지 계산:**
        * 단일 `damage_type` 대신, `physical_damage_base`, `physical_damage_coeff_attack_power`, `magical_damage_base`, `magical_damage_coeff_spell_power` 등의 필드를 통해 각 레벨별 고정 피해량 및 스탯 계수를 명시합니다.
        * 최종 데미지는 코드 내에서 `(고정 물리 + 공격력*계수) + (고정 마법 + 주문력*계수)` 형태로 계산됩니다.
    * **상태 이상 및 버프/디버프:** `PotionEffect`를 사용하지 않고, Minecraft Attribute 직접 조작 (`MODIFY_ATTRIBUTE`) 또는 커스텀 상태이상 로직 (`APPLY_CUSTOM_STATUS`)으로 구현합니다.
        * `MODIFY_ATTRIBUTE`: 대상, 속성 ID, 연산 방식, 수치, 지속시간, 고유 이름(제거용) 등을 명시.
        * `APPLY_CUSTOM_STATUS`: 커스텀 상태이상 ID, 관련 수치, 지속시간 등을 명시.
* **스킬 업그레이드 비용 (`upgrade_cost_per_level` 하위 섹션):**
    * 각 레벨(다음 레벨)로 업그레이드하는 데 필요한 `xp` 비용을 명시합니다.

### 3. 스킬 관리자 (SkillManager - 코드 내)

* YAML 파일에서 모든 스킬 정보를 로드하여 내부 자료구조에 저장 및 관리.
* 스킬 정보 조회 API 제공.
* 스킬 실행 로직 총괄: 플레이어의 스킬 사용 요청 시, 현재 스킬 레벨, MP, 쿨타임 등 확인 후 YAML에 정의된 효과들을 순차적/조건부로 발동 (코드 내 "Effect Handler" 모듈들 호출).
* 스킬 설정 리로드 기능 구현 (관리자 명령어로 실행). 리로드 시 발생 가능한 문제점(플레이어 데이터와의 동기화 등)은 인지하고 있으며, 소규모 서버 특성을 고려하여 관리자 개입으로 단순화할 수 있음.

### 4. 플레이어 스킬 데이터 (playerdata/{UUID}.yml)

* `learned_skills`: `{ "스킬ID": 현재레벨, ... }`
* `equipped_active_skills`: `{ "SLOT_Q": "스킬ID", "SLOT_F": "스킬ID", "SLOT_SHIFT_Q": "스킬ID" }`
* `equipped_passive_skills`: `[ "스킬ID_1", "스킬ID_2", "스킬ID_3" ]`
* `skill_cooldowns`: `{ "스킬ID": 종료타임스탬프, ... }`

### 5. 스킬 GUI 시스템 (2개 GUI)

* **GUI 1: 스킬 관리창 (예: `/skills`)**
    * 현재 장착된 액티브 3개, 패시브 3개 스킬 표시.
    * 각 스킬은 **3개의 GUI 슬롯("블록")**으로 구성:
        * **슬롯 1 (정보):** 스킬 아이콘, 이름, 현재 레벨, 상세 설명 (현 레벨 기준 효과, MP, 쿨타임 등).
        * **슬롯 2 (강화):** 강화 버튼 아이콘. Lore에 다음 레벨 효과 및 필요 XP 표시. (우클릭 시 즉시 강화).
        * **슬롯 3 (교체):** 교체 버튼 아이콘. 클릭 시 GUI 2(스킬 라이브러리) 오픈.
    * 액티브/패시브 스킬 블록 구분 표시.
* **GUI 2: 스킬 라이브러리/선택창 (GUI 1의 "교체" 버튼으로 오픈)**
    * 현재 클래스가 **습득한 스킬 중 미장착 스킬** 목록 표시.
    * **습득한 스킬 아이콘:** "인챈트된 책" (Lore에 스킬 정보).
    * **미습득 스킬 아이콘:** "회색 유리판" (Lore에 획득 힌트 제공).
    * 스킬 수가 많을 경우 **페이지네이션 기능 필수.**
    * 스킬 아이콘 클릭 시 GUI 1의 해당 "블록"에 스킬 장착/교체.

## 5. RPGCore+ 커스텀 장비 시스템 상세 요약
### 1. 기본 철학 및 데이터 관리

* **YAML 기반 정의:** 각 커스텀 장비 아이템은 개별 YAML 파일을 통해 상세하게 정의됩니다.
* **디렉토리 구조:** 플러그인 데이터 폴더 내 `equipment` 폴더를 기본으로 하며, 그 하위에 장비 종류별 폴더(예: `weapons`, `armor/helmets`, `accessories/rings` 등)를 두어 체계적으로 관리합니다. (예: `equipment/weapons/epic_sword.yml`)
* **리로드 가능성:** 서버 실행 중에도 장비 설정을 다시 불러올 수 있는 기능을 목표로 설계합니다.
* **장비 등급/희귀도 (`tier`):** 명시적인 `tier` 또는 `rarity` 필드는 YAML에 **사용하지 않습니다.** 아이템의 가치와 성능은 기본 스탯, 고유 효과, 그리고 강화 시스템을 통해 결정됩니다.

### 2. 장비 속성 정의 (YAML)

각 장비 아이템 YAML 파일에는 다음과 같은 주요 속성들이 정의됩니다:

* **`internal_id`:** (파일명 또는 파일 내 고유 키로 사용) 플러그인 내부에서 아이템을 식별하는 고유 ID.
* **`display_name`:** 게임 내에 표시될 아이템 이름 (Minecraft 색상 코드 지원).
* **`material`:** 아이템의 기반이 될 바닐라 Minecraft 아이템의 Material 타입 (예: `DIAMOND_SWORD`).
* **`custom_model_data`:** (정수) 리소스팩을 통해 적용될 커스텀 모델 데이터 ID.
* **`lore`:** 아이템 설명 (문자열 리스트, Minecraft 색상 코드 지원).
* **`equipment_type`:** 장비의 종류를 나타내는 식별자 (예: `WEAPON_SWORD`, `WEAPON_BOW`, `WEAPON_CUSTOM_GUN`, `ARMOR_HELMET`, `ARMOR_CHESTPLATE`, `ARMOR_LEGGINGS`, `ARMOR_BOOTS`, `ACCESSORY_RING`, `ACCESSORY_NECKLACE`, `ACCESSORY_EARRINGS`, `ACCESSORY_BRACELET`, `ARMOR_GLOVES`, `ARMOR_BELT`, `ARMOR_CLOAK`).
* **착용 요구 조건 (`requirements`):**
    * `level`: 착용에 필요한 최소 플레이어 레벨.
    * `class`: (선택 사항) 착용 가능한 클래스 ID 목록 (예: `["warrior_frenzy", "assassin_gale_striker"]`).
    * (선택 사항) 특정 스탯 최소 요구치 (예: `strength: 100`).
* **내구도:** 별도의 내구도 시스템은 **구현하지 않으며**, 모든 커스텀 장비는 무한 내구도를 가집니다.
* **장비 강화 시스템:**
    * `max_upgrade_level`: 해당 장비의 최대 강화 가능 레벨 (예: 10).
    * `base_stats`: 강화 레벨 0 (미강화 상태)일 때의 기본 스탯.
        * `stats_additive`: `{ STAT_ID: 값, ... }` (합연산으로 적용될 고정 스탯 보너스)
        * `stats_multiplicative`: `{ STAT_ID: 값, ... }` (곱연산으로 적용될 비율 스탯 보너스, 예: 0.05는 +5%)
    * `upgrades`: 각 강화 레벨로 도달하기 위한 정보를 담는 맵.
        * `1`: (0 -> 1레벨 강화 정보)
            * `xp_cost_to_reach`: 1레벨 달성에 필요한 XP 비용.
            * `stats_additive`: `{ STAT_ID: 값, ... }` (1레벨일 때의 총 합연산 스탯)
            * `stats_multiplicative`: `{ STAT_ID: 값, ... }` (1레벨일 때의 총 곱연산 스탯)
        * `2`: (1 -> 2레벨 강화 정보) ... `max_upgrade_level`까지 반복.
* **고유 효과 (`unique_effects_on_equip`, `unique_effects_on_hit_dealt`, `unique_effects_on_hit_taken` 등):**
    * 장비 착용 시, 공격 성공 시, 피격 시 등 특정 조건에서 발동하는 특수 효과.
    * 이 효과들은 **커스텀 스킬 시스템의 `effects` 블록과 동일한 구조 및 "Effect Handler" 메커니즘**을 사용하여 정의됩니다. (예: `type: MODIFY_ATTRIBUTE`, `type: APPLY_CUSTOM_STATUS`, `chance` (발동 확률) 등 포함 가능)
* **세트 아이템 ID (`set_id`):** (선택 사항) 이 장비가 특정 장비 세트에 속할 경우 해당 세트의 고유 ID를 명시.
* **무기 기본 공격 속도 (`base_cooldown_ms`):** (무기 타입일 경우) 커스텀 공격 속도 시스템에서 사용될 해당 무기의 기본 공격 딜레이(ms).

### 3. 스탯 적용 방식

* 장비로부터 오는 모든 합연산 스탯(`stats_additive`)은 플레이어의 최종 스탯 계산 시 전체 "합연산 총합" 부분에 더해집니다.
* 장비로부터 오는 모든 곱연산 스탯(`stats_multiplicative`)은 플레이어의 최종 스탯 계산 시 전체 "곱연산 총곱" 부분에 다른 곱연산자들과 함께 곱해져 반영됩니다. (스탯 시스템에서 정의된 글로벌 공식 따름)

### 4. 커스텀 장비 GUI 및 슬롯

* **전용 GUI:** 마인크래프트 기본 장비 슬롯 대신, RPG 장비 착용 및 강화를 위한 **별도의 커스텀 GUI**를 사용합니다.
* **커스텀 슬롯 (총 12개, 각 1개씩 착용):**
    1.  무기 (Weapon)
    2.  헬멧 (Helmet)
    3.  흉갑 (Chestplate)
    4.  레깅스 (Leggings)
    5.  신발 (Boots)
    6.  반지 (Ring)
    7.  팔찌 (Bracelet)
    8.  목걸이 (Necklace)
    9.  귀고리 (Earrings)
    10. 장갑 (Gloves)
    11. 벨트 (Belt)
    12. 망토 (Cloak)
* **플레이어 데이터 저장:** 이 12개 커스텀 슬롯에 장착된 아이템 정보는 `playerdata/{UUID}.yml` 파일에 저장됩니다.
* **바닐라 장비 슬롯의 역할:** 순수 **외형 꾸미기(코디) 용도**로만 사용되며, 이 슬롯에 착용된 아이템은 RPG 스탯이나 효과를 **전혀 제공하지 않습니다.**

### 5. 장비 세트 효과

* 세트 효과는 해당 세트에 정의된 **모든 부위의 장비를 착용해야만 발동**됩니다. (부분 세트 효과 없음)
* 세트 효과의 상세 내용(제공 스탯, 고유 효과 등)은 별도의 YAML 파일(예: `equipment_sets.yml`)에서 정의하고 관리합니다.

### 6. 장비 관리자 (EquipmentManager - 코드 내)

* 모든 장비 YAML 파일을 로드하여 파싱하고 내부 데이터로 관리합니다.
* 장비 정의를 바탕으로 NBT 태그가 적용된 실제 `ItemStack`을 생성합니다. (NBT에는 아이템 고유ID, 현재 강화 레벨 등의 중요 정보 포함)
* 플레이어가 커스텀 장비 슬롯에 아이템을 착용/해제할 때, 스탯 변경 및 고유 효과 적용/제거 로직을 처리합니다.
* 장비 설정 리로드 기능을 지원합니다.

## 6. RPGCore+ 커스텀 장비 제작 시스템 상세 요약
### 1. 기본 철학 및 원칙

* **확정적 제작:** 모든 제작 시도는 재료와 조건만 충족되면 **항상 성공**합니다. (성공/실패 확률, 대성공 없음)
* **레시피 습득 기반:** 플레이어는 특정 몬스터나 보스를 처치할 때 일정 확률로 "레시피 아이템"을 획득하거나 "레시피를 직접 습득"하여 해당 아이템을 제작할 수 있게 됩니다. (플레이어 데이터에 습득한 레시피 목록 저장)
* **YAML 기반 설정:** 모든 레시피와 커스텀 재료는 YAML 파일을 통해 정의되며, 서버 실행 중 리로드 가능성을 목표로 합니다.

### 2. 제작 레시피 데이터 정의 (YAML)

* **파일 구조:**
    * 플러그인 데이터 폴더 내 `crafting_recipes` 폴더를 사용합니다.
    * 각 **개별 레시피마다 하나의 YAML 파일을 사용**하며, 이 파일들은 장비 종류별 하위 디렉토리(예: `crafting_recipes/weapons/`, `crafting_recipes/armor/helmets/` 등)에 저장됩니다.
* **주요 YAML 속성 (개별 레시피 파일 내):**
    * `recipe_id`: 레시피의 고유 내부 식별자 (예: `craft_epic_sword_01`).
    * `output`:
        * `item_internal_name`: 제작될 결과물인 커스텀 장비의 내부 ID (`equipment` 시스템의 아이템 ID와 연결).
        * (결과물 수량은 항상 1, 제작 시 강화 레벨은 항상 0이므로 YAML에 별도 명시 X).
    * `xp_cost`: 제작에 필요한 총 Raw XP.
    * `ingredients`: (리스트) 필요한 재료 아이템 목록. 각 재료 항목은 다음을 포함:
        * `item_type`: 재료의 종류 (`VANILLA`, `RPGCORE_CUSTOM_MATERIAL`, `RPGCORE_CUSTOM_EQUIPMENT`).
        * `item_id`: 바닐라 아이템의 Material ID 또는 커스텀 아이템/장비의 내부 ID.
        * `amount`: 필요한 수량.
* **미사용 속성:**
    * 별도의 제작대 블록(`crafting_station_id`)은 사용하지 않음 (GUI 내에서 제작).
    * 제작에 필요한 생활 기술 레벨(`required_life_skills`)은 요구하지 않음.
    * 레시피 YAML 내 별도의 해금 조건(`unlock_conditions`)은 없음 (레시피 자체를 습득하는 방식).

### 3. 커스텀 제작 재료 정의 (YAML)

* **파일 구조:** 플러그인 데이터 폴더 내 `custom_materials` 폴더에 각 **개별 커스텀 재료마다 하나의 YAML 파일**을 사용합니다. (예: `custom_materials/dragon_scale.yml`)
* **주요 YAML 속성:**
    * `internal_id`: (파일명 또는 파일 내 고유 키) 재료의 고유 내부 ID.
    * `display_name`: 게임 내 표시 이름.
    * `material`: 기반이 될 바닐라 아이템 Material (텍스처 표현용).
    * `custom_model_data`: 커스텀 모델 데이터 ID.
    * `lore`: 아이템 설명.
* **획득처:** 몬스터 드롭, 채집/광질 시 희귀 획득, 퀘스트 보상 등 다양한 경로로 공급.

### 4. 제작 관련 GUI 흐름 (다단계)

* **진입점:** `/equip` 명령어로 여는 "장비 장착 및 관리 GUI" 내의 특정 버튼을 통해 "장비 제작 GUI"로 진입합니다.
* **장비 장착 및 관리 GUI (`/equip`):**
    * **기능:** 현재 착용 중인 12종 커스텀 장비 표시, 강화, 해제, 활성 세트 효과 확인, 제작 GUI 진입.
    * **레이아웃 (예상: 6x9=54칸):**
        * **1~4번째 줄:** 12개의 각 장비 파츠는 3개의 GUI 슬롯("블록")으로 구성되어 표시됨 (착용 아이템 아이콘, 강화 버튼, 해제 버튼).
        * **5번째 줄:** 현재 활성화된 최대 3종류의 세트 효과(주 장비, 보조 장비, 장신구) 아이콘 표시.
        * **6번째 줄:** "장비 제작 GUI로 이동" 버튼 아이콘 배치.
* **GUI 1: 장비 제작 카테고리 선택창 (제작 메인 메뉴):**
    * **기능:** 제작할 장비의 부위(카테고리) 선택.
    * **레이아웃 (예상: 3x9=27칸):** 12종류의 장비 파츠(무기, 헬멧 등) 아이콘을 세트 그룹(주 장비, 보조 장비, 장신구)별로 줄을 나누어 표시.
* **GUI 2: 특정 파츠 제작 레시피 목록창:**
    * **기능:** GUI 1에서 선택한 장비 파츠에 대해 플레이어가 습득한 레시피 목록 표시 및 제작 실행.
    * **크기 및 기능:** **6x9 (54칸) GUI**이며, **페이지네이션(페이지 넘김) 기능 필수.**
    * **표시 내용:**
        * 선택한 파츠에 대해 플레이어가 **습득한 모든 레시피의 결과물 아이템 아이콘**을 나열.
        * **필터링:** 무기의 경우, 현재 플레이어의 클래스가 장착 가능한 무기 레시피만 표시.
        * **레시피 정보:** 아이콘에 마우스오버 시 Lore를 통해 필요한 재료 목록 및 XP 비용 표시.
        * (재료 보유 여부는 이 단계에서 확인하지 않고, 실제 제작 시도 시 확인)
    * **제작 실행:** 제작 원하는 아이템 아이콘 **우클릭** 시, 재료 및 XP 충족 여부 확인 후 **별도의 확인 절차 없이 즉시 제작** 완료. 완성품은 플레이어 인벤토리로 지급.

### 5. 제작 실행 로직 (CraftingManager - 코드 내)

* 모든 레시피 및 커스텀 재료 YAML 파일을 로드하여 관리.
* 플레이어별 습득한 레시피 데이터(`learned_recipes`) 관리.
* 모든 제작 관련 GUI 상호작용 처리.
* GUI 2에서 제작 시도(우클릭) 시 다음을 검증하고 실행:
    1.  플레이어가 해당 레시피를 습득했는지 확인.
    2.  플레이어 인벤토리에 모든 필요 재료가 충분한지 확인.
    3.  플레이어가 요구 XP를 보유하고 있는지 확인.
    4.  모든 조건 충족 시: 재료 및 XP 차감, 결과물 아이템 생성(`EquipmentManager` 통해) 및 지급, 성공 피드백(사운드, 파티클 등) 재생.

## 7. RPGCore+ 전투 시스템 상세 요약
### 1. 기본 HP 및 데미지 처리

* **커스텀 HP 시스템:**
    * 플레이어와 몬스터 모두 플러그인 내부의 커스텀 변수(`CurrentHP_Custom`, `MaxHP_Custom`)로 HP를 관리합니다.
    * 바닐라 하트 GUI는 실제 HP를 정확히 반영하기 어려우므로, 플레이어의 실제 HP는 다른 UI(스코어보드, 액션바 등)를 통해 표시하고 바닐라 HP는 항상 최대로 고정하거나 다른 용도로 활용하는 것을 고려합니다.
    * 모든 피해 계산 및 적용은 이 커스텀 HP를 기준으로 이루어집니다. `CurrentHP_Custom`이 0 이하가 되면 해당 엔티티는 사망 처리됩니다.
* **피격 시 무적 시간:**
    * **플레이어:** 피격 후 **0.5초 (10틱)의 커스텀 무적 시간**을 가집니다. 이 시간 동안 추가 피해를 받지 않도록 플러그인이 관리합니다.
    * **몬스터:** 피격 후 **무적 시간이 없습니다.** 연속적인 빠른 공격에 모든 피해를 받습니다.
    * (바닐라 `noDamageTicks`는 플러그인의 커스텀 데미지 및 무적 시간 처리 로직에 의해 제어되거나 무시됩니다.)

### 2. 최종 데미지 계산 공식

* **기본 구조:** `최종 데미지 = 최종 물리 데미지 + 최종 마법 데미지`
    * 각 데미지 요소는 별도로 계산된 후 합산됩니다.

* **최종 물리 데미지:**
    * `(공격자 최종 공격력) * (공격의 물리 계수) * (is_valid_weapon) * (100) / (100 + 피해자 최종 방어력)`

* **최종 마법 데미지:**
    * `(공격자 최종 주문력) * (공격의 마법 계수) * (is_valid_weapon) * (100) / (100 + 피해자 최종 마법저항력)`

### 3. 데미지 공식 주요 구성 요소

* **공격자 최종 공격력/주문력:** 스탯 시스템을 통해 계산된 플레이어 또는 몬스터의 최종 스탯 값.
* **공격의 물리/마법 계수:**
    * **스킬 공격 시:** 각 스킬의 YAML 파일 내 현재 레벨에 정의된 물리 계수 및 마법 계수 값을 사용합니다. 스킬은 고정 피해량도 가질 수 있으며, 이는 계수 피해량에 합산됩니다: `(공격력 * 물리계수) + (주문력 * 마법계수) + 스킬 고정피해`.
    * **기본 공격(평타) 시:** **물리 계수 1.0, 마법 계수 0.0**을 적용합니다. (즉, 순수 물리 피해)
* **`is_valid_weapon` 팩터:**
    * 플레이어의 바닐라 `mainhand`에 들고 있는 아이템의 `Material` 타입이 현재 플레이어의 클래스에 "허용된 `Material` 목록"(YAML로 관리)에 포함되는지 여부로 결정됩니다.
    * 허용된 경우 1, 아니면 0의 값을 가집니다. 데미지가 0이 될 뿐만 아니라, 스킬 사용 시도 자체가 취소됩니다(MP 소모 X, 쿨타임 X).
    * 이 메커니즘은 플레이어가 RPG 커스텀 슬롯에 주무기를 착용하고, 바닐라 `mainhand`에는 해당 무기 타입에 맞는 외형의 아이템(Material 기준)을 들어야만 전투 행위가 가능하도록 합니다.
* **피해자 최종 방어력/마법저항력:** 스탯 시스템을 통해 계산된 대상의 최종 방어/마법저항력 값. 피해 감소 공식 `100 / (100 + 방어수치)`는 방어수치가 100일 때 50%의 피해 감소를 의미합니다.

### 4. 치명타 (Critical Hit) 메커니즘

* **발동:** 공격자의 `치명타 확률` 스탯에 기반하여 확률적으로 결정됩니다.
* **기본 효과 (모든 치명타에 공통 적용):**
    1.  피격 대상의 `방어력`과 `마법저항력`을 계산 시 각각 **절반(50%)으로 간주**합니다.
    2.  이렇게 감소된 방어/마저를 기준으로 물리/마법 데미지를 계산한 후 합산합니다.
    3.  이 합산된 값에 **1.25배의 피해 증폭**을 적용합니다.
* **클래스별 특수 치명타 효과:** 특정 클래스(예: 명사수, 질풍검객)는 자신의 고유 메커니즘이나 스킬을 통해 이 기본 치명타 효과를 강화하거나(예: 방어력 무시율 증가, 최종 피해 배율 증가), 추가적인 효과를 부여할 수 있습니다. (세부 사항은 각 클래스 설계 시 구체화)

### 5. 최종 데미지 증폭/감소 버프 및 디버프

* 위 모든 계산(치명타 포함)이 완료된 "산출된 데미지"에, 공격자 또는 대상에게 적용 중인 모든 종류의 최종 피해량 % 증감 효과(스킬, 장비, 상태 이상 등)가 곱연산으로 적용됩니다.
* `실제 적용 데미지 = (산출된 데미지) * (1 + 총 피해 증가 효과율 - 총 피해 감소 효과율)`

### 6. 상태 이상 효과 (Status Effects)

* 바닐라 `PotionEffect`를 **사용하지 않습니다.**
* 모든 상태 이상(버프, 디버프, 지속 피해(DoT), 군중 제어(CC) 등)은 커스텀 로직 및 Minecraft Attribute 직접 조작으로 구현됩니다.
* 각 상태 이상은 YAML 파일에 고유 ID, 효과 타입, 지속시간(영구 가능), 중첩 규칙, 실제 효과 로직(Attribute 변경, 주기적 피해 등) 등을 상세히 정의합니다.
* `StatusEffectManager`가 적용, 관리, 해제 등을 담당합니다.
* 플레이어에게 적용/해제 시 **채팅창 메시지**로 알립니다.
* **정화/회복 포션은 없으며,** `is_cleansable` 속성은 현재로서는 큰 의미가 없습니다. 상태 이상은 주로 지속시간 만료, 사망, 또는 특정 메커니즘(예: 원소술사의 엘리멘탈 익스플로전)에 의해 해제됩니다.

### 7. 어그로 (Aggro/Threat) 시스템

* **수치 기반 어그로 테이블을 사용하지 않고, 상태 및 우선순위 기반**으로 작동합니다.
* **기본 타겟팅:** 몬스터는 일반적으로 가장 **근접한** 대상을 공격합니다. (동일 거리 시 먼저 인식된 대상 유지)
* **타겟 고정성 (Stickiness):** 한번 타겟이 정해지면, 해당 타겟이 죽거나, 몬스터의 인식 범위를 벗어나거나, 다른 타겟 변경 스킬(도발, 공포 등)에 맞지 않는 한 타겟을 쉽게 바꾸지 않습니다.
* **도발 스킬:** 피격된 몬스터의 타겟을 시전자에게 **영구적으로(위의 조건 발생 전까지) 고정**시킵니다.
* **공포 스킬:** 피격된 몬스터는 시전자로부터 도망가며, 공포 지속시간 동안 타겟팅이 초기화됩니다. 공포 종료 후 자신의 기본 로직에 따라 타겟을 재선정합니다.
* **몬스터별 특수 AI:** 특정 몬스터는 고유한 타겟팅 로직을 가질 수 있습니다.
* **데미지량과 어그로:** 플레이어가 입힌 **데미지량은 몬스터 어그로에 영향을 주지 않습니다.**

### 8. 기타 전투 관련 규칙

* **명중/회피 판정:** 모든 공격(기본 공격, 스킬)은 사거리 및 타겟팅 조건 충족 시 **항상 명중**하는 것을 기본으로 합니다. (별도의 명중률/회피율 스탯 및 판정 없음)
* **PvP (Player vs. Player):** 서버에서 **완전히 비활성화**됩니다.
* **위치 기반 데미지 보너스 (예: 백스탭):** 일반적인 시스템으로는 존재하지 않으며, 특정 스킬이나 클래스의 고유 능력으로만 구현될 수 있습니다.
* **투사체 규칙:**
    * 각 스킬마다 투사체의 물리적 특성(속도, 중력 영향, 튕김 등)을 개별적으로 정의 가능.
    * 유도 기능이 있는 투사체를 선호 (구현이 어려울 시 "지연된 확정 타격"으로 대체 가능).
    * 관통 효과는 명사수 외 다른 클래스도 스킬을 통해 가질 수 있음 (스킬별 개별 정의).
    * 투사체에 의한 지형 파괴 기능은 없음.
    * 투사체 착탄 지점에 장판 등의 효과 생성은 가능 (스킬 효과로 정의).

### 9. 회복 메커니즘

* **흡혈 (Lifesteal):**
    * `물리 회복량 = 최종 물리 피해량 * 물리 흡혈%`
    * `마법 회복량 = 최종 마법 피해량 * 주문 흡혈%`
    * 총 회복량은 공격자의 현재 HP에 더해지며, 최대 HP를 넘지 않음.
* **자연 회복:** 매 5초마다 `최대 HP의 0.1% (최소 1)` 및 `최대 MP의 1% (최소 1)` 자동 회복.
* **포션 및 음식:** (추후 "포션 및 음식 시스템"에서 상세화) 섭취 즉시 현재 HP/MP를 직접 증감 (최대치 영향 X).

## 8. RPGCore+ 커스텀 몬스터 및 무한 던전 시스템 상세 요약
### 1. 커스텀 몬스터 시스템 (Custom Monster System - 아키텍처)

* **기본 목표:** 마인크래프트 바닐라 몹의 외형을 사용하되, 플러그인 자체적으로 커스텀 스탯, 능력(스킬), 행동 패턴(어그로), 드롭 아이템을 가진 새로운 몬스터를 구현합니다. 외부 몹 플러그인(예: MythicMobs)은 사용하지 않습니다.
* **데이터 정의 (YAML 기반):**
    * **파일 구조:** 각 커스텀 몬스터는 개별 YAML 파일(예: `monsters/goblin_warrior.yml`) 또는 통합된 몬스터 설정 파일 내의 섹션으로 정의됩니다.
    * **주요 속성 (몬스터별):**
        * `monster_id`: (문자열) 몬스터의 고유 내부 ID.
        * `display_name`: (문자열) 게임 내 표시될 이름 (색상 코드 지원).
        * `vanilla_mob_type_for_appearance`: (문자열) 외형으로 사용할 바닐라 몬스터 타입 (예: `ZOMBIE`, `SKELETON`). 이 몹의 기본 이동 방식 등 일부 AI를 활용할 수 있습니다.
        * `stats`: (맵) RPGCore+의 커스텀 스탯 시스템을 따르는 몬스터의 기본 스탯.
            * `MaxHP_Custom`, `AttackPower_Custom`, `DefensePower_Custom`, `SpellPower_Custom` (마법 공격 시), `MagicalResistance_Custom` (마법 공격 시), `AttackSpeed_Custom_cooldownMs` (기본 공격 딜레이), `MovementSpeed_Custom` (이동 속도 배율 또는 절대값) 등.
        * `skills_or_special_abilities`: (리스트) 몬스터가 사용하는 스킬의 `internal_id` 목록 또는 간단한 특수 능력(예: 자가 치유, 특정 조건부 버프) 정의. RPGCore+의 커스텀 스킬 시스템 아키텍처를 활용하여 몬스터도 스킬 사용 가능.
        * `aggro_type`: (문자열) 몬스터의 어그로 및 타겟팅 방식 (예: `DEFAULT_PROXIMITY`, `ASSASSIN_TARGET_FURTHEST` 등, 어그로 시스템에서 정의된 타입 또는 커스텀 AI 스크립트 ID).
        * `xp_reward`: (정수) 해당 몬스터 처치 시 플레이어가 얻는 XP.
        * `drop_table_id`: (문자열, 선택 사항) 해당 몬스터가 아이템을 드롭할 경우, 사용할 드롭 테이블의 고유 ID.
        * `is_boss_monster`: (boolean, 기본값 `false`) 보스급 몬스터인지 여부.

### 2. 드롭 테이블 시스템 (Loot Table System - 몬스터 시스템 지원)

* **데이터 정의 (YAML 기반):**
    * 각 드롭 테이블은 고유 ID를 가지며, 별도의 YAML 파일(예: `loot_tables/goblin_drops.yml`) 또는 통합 파일 내 섹션으로 정의됩니다.
    * **주요 속성 (드롭 테이블별):**
        * `table_id`: 드롭 테이블의 고유 내부 ID.
        * `drops`: (리스트) 해당 테이블에서 나올 수 있는 아이템 목록. 각 아이템 항목은 다음을 포함:
            * `type`: 드롭 아이템의 종류 (`VANILLA_ITEM`, `RPGCORE_CUSTOM_MATERIAL`, `RPGCORE_CUSTOM_EQUIPMENT`, `RPGCORE_SKILL_UNLOCK`, `RPGCORE_RECIPE_UNLOCK`).
            * `id`: 바닐라 아이템 Material, 커스텀 아이템/장비/스킬/레시피의 내부 ID.
            * `quantity_min`, `quantity_max`: 최소/최대 드롭 수량.
            * `chance`: 드롭 확률 (0.0 ~ 1.0).
* **특수 드롭 처리 (`RPGCORE_SKILL_UNLOCK`, `RPGCORE_RECIPE_UNLOCK`):**
    * 이 타입으로 지정된 보상은 몬스터가 물리적인 아이템을 드롭하는 대신, 조건(예: 처치 기여)을 만족하는 플레이어에게 **즉시 해당 스킬 또는 레시피가 습득 처리**됩니다.
    * 플레이어에게는 관련 습득 알림 메시지가 채팅창으로 전송됩니다.

### 3. 무한 던전 시스템 (Infinite Dungeon System)

* **핵심 컨셉:** 플레이어 사망 전까지 점점 더 강해지는 몬스터가 계속해서 스폰되는 1인용 도전 콘텐츠.
* **입장 방식:** 명령어 기반 (예: `/infinite join`).
* **인스턴스 및 지역 관리:**
    * 미리 만들어진 **동일한 디자인의 격리된 경기장 3개**를 활용.
    * 입장 시, 플러그인이 비어있는 경기장으로 플레이어를 배정.
    * 던전 종료(플레이어 사망) 시 해당 경기장 내부를 초기화 (남은 몬스터 제거 등) 후 재사용 가능 상태로 전환.
* **웨이브 진행:**
    * 현재 웨이브의 **모든 몬스터를 처치**하면 다음 웨이브로 진행.
    * 웨이브 종료 후 다음 웨이브 시작 전까지 **5초의 준비 시간** 제공.
* **몬스터 스폰:**
    * **일반 웨이브:**
        * 미리 정의된 약 **5가지 종류의 커스텀 몬스터 풀** (예: 근접 2, 원거리 2, 마법사 1)에서 몬스터가 등장. 이 풀의 몬스터 종류는 웨이브가 진행되어도 변경되지 않음.
        * 등장하는 **몬스터의 수는 매 10 웨이브마다 (정확히는 보스 웨이브 직후인 Wave 11, 21, 31... 부터) 고정된 수(+N 마리)만큼 증가.** (N의 구체적인 값은 밸런싱 필요)
    * **보스 웨이브:**
        * **매 10번째 웨이브마다 (Wave 10, 20, 30...) 보스 몬스터가 단독으로 등장.**
        * 등장하는 보스는 미리 정의된 여러 종류의 보스 몬스터 풀에서 **무작위로 하나가 선택**됨.
    * **스폰 위치:** 던전 경기장 내부의 정의된 공간 내에서 **무작위 위치**에 스폰.
* **난이도 상승 (몬스터 스탯 스케일링):**
    * 등장하는 모든 몬스터(일반, 보스 포함)의 기본 스탯(HP, 공격력 등)은 **웨이브 번호에 따라 2차 함수 (`배율 = a * 웨이브² + b * 웨이브 + c`)에 비례하여 증가하는 배율이 적용**되어 강화됨. (계수 a, b, c는 밸런싱 필요)
* **보상 시스템:**
    * 웨이브 클리어 또는 던전 완료에 따른 **별도의 직접적인 보상은 없음.**
    * 모든 보상은 오직 던전 내에서 **몬스터를 처치했을 때, 해당 몬스터의 커스텀 드롭 테이블에 따라 드롭되는 아이템/스킬/레시피** 형태로만 제공됨.
* **종료 조건 및 사후 처리:**
    * **주요 종료 조건:** 플레이어의 사망.
    * **사망 후 스폰 위치:** 오버월드의 자신이 설정한 리스폰 지점(침대 또는 기본 스폰).
    * **페널티:** 던전에서 사망하여 퇴장한 플레이어는 **10분의 무한 던전 재입장 대기시간(쿨타임)**을 가짐. 그 외 아이템/XP 페널티는 없음 (서버 전체 `keepInventory=true` 및 사망 시 XP 손실 없음 규칙 따름).
* **리더보드 시스템:**
    * 명령어 `/infinite ranking`을 통해 접근 가능.
    * **최고 도달 웨이브**를 기준으로 상위 최대 3명의 플레이어 순위를 표시.
* **관련 명령어 구조:**
    * 모든 무한 던전 관련 명령어는 `/infinite <하위명령어> [인자...]` 형식을 따름.

## 9. RPGCore+ 음식 시스템 상세 요약 (포션 시스템 제외)
### 1. 기본 철학 및 목표

* **허기 시스템 대체:** 마인크래프트 바닐라의 허기 및 포만감 시스템은 사용하지 않습니다. 플레이어의 허기 수치는 항상 최대로 유지되거나, 관련 이벤트(`FoodLevelChangeEvent`)가 취소되어 실질적인 영향을 미치지 않도록 합니다.
* **음식의 새로운 역할:** 모든 음식 아이템(바닐라 및 커스텀)은 섭취 시 플레이어의 커스텀 HP (`CurrentHP_Custom`) 및 커스텀 MP (`CurrentMP_Custom`)를 직접적으로 회복시키는 주요 수단이 됩니다. 최대 HP/MP 자체를 변경하지는 않습니다.
* **커스텀 포션 미도입:** 별도의 RPGCore+ 전용 커스텀 포션 아이템 및 관련 시스템은 이번 단계에서는 구현하지 않습니다.

### 2. 음식 아이템 효과 정의 (YAML 기반)

* **바닐라 음식 효과 재정의 (`foods.yml`):**
    * 플러그인 설정 폴더 내에 `foods.yml` (또는 유사한 이름의) 설정 파일을 사용합니다.
    * 각 바닐라 음식 아이템의 `Material` Enum 이름을 키로 사용하여 효과를 개별적으로 정의합니다.
    * **주요 속성 (음식 아이템별):**
        * `hp_restore_flat`: (정수, 선택) 섭취 시 회복될 고정 HP 양.
        * `hp_restore_percent_max`: (소수, 선택) 섭취 시 플레이어의 `MaxHP_Custom` 기준 %로 회복될 HP 양 (예: `0.05`는 최대 HP의 5%).
        * `mp_restore_flat`: (정수, 선택) 섭취 시 회복될 고정 MP 양.
        * `mp_restore_percent_max`: (소수, 선택) 섭취 시 플레이어의 `MaxMP_Custom` 기준 %로 회복될 MP 양.
        * `consume_duration_ticks`: (정수, 선택) 해당 음식의 섭취 시간(틱 단위). 미지정 시 바닐라 기본 섭취 시간을 따릅니다.
        * `apply_custom_status_on_consume`: (리스트, 선택) 섭취 시 플레이어에게 부여할 커스텀 상태 이상(버프/디버프) 목록. 각 항목은 `status_id`, `duration_ticks` (또는 `duration_formula`), `value` (또는 `value_formula`) 등을 포함할 수 있으며, 이는 "커스텀 상태 이상 시스템"과 연동됩니다. (바닐라 음식의 경우 효과가 미미하거나 짧게 유지되도록 밸런싱)
    * **회복량 계산:** 총 HP 회복량 = `hp_restore_flat` + (`MaxHP_Custom` * `hp_restore_percent_max`). MP도 동일하게 계산. `_flat` 또는 `_percent_max` 항목이 YAML에 없으면 해당 부분은 0으로 간주.
    * **기본 회복량:** `foods.yml`에 정의되지 않은 음식은 기본적으로 HP/MP 회복 효과가 0입니다.
* **커스텀 음식 아이템 (리소스팩/데이터팩 활용 시):**
    * 새로운 커스텀 음식 아이템을 추가할 경우, 해당 아이템은 고유 `internal_id`를 가지며, 별도의 YAML 파일(예: `custom_items/foods/epic_stew.yml`) 또는 통합된 커스텀 아이템 파일에 정의될 수 있습니다.
    * 정의에는 일반적인 커스텀 아이템 속성(`display_name`, 기반 `material`, `custom_model_data`, `lore`) 외에, 위 바닐라 음식과 동일한 음식 효과 관련 속성들(`hp_restore_flat`, `apply_custom_status_on_consume` 등)이 포함됩니다.
    * 커스텀 음식은 더 강력하거나 특별한 회복 효과 및 버프를 제공할 수 있습니다.

### 3. 핵심 로직 (코드 내)

* **허기 시스템 비활성화:** `FoodLevelChangeEvent`를 지속적으로 취소하고, 플레이어의 바닐라 허기 수치를 항상 최대로 유지합니다.
* **아이템 섭취 이벤트 처리 (`PlayerItemConsumeEvent`):**
    1.  플레이어가 아이템을 섭취하면 이벤트를 감지합니다.
    2.  섭취한 아이템이 RPGCore+의 커스텀 음식인지 NBT 태그 등을 통해 먼저 확인합니다.
        * **커스텀 음식인 경우:** 해당 커스텀 음식의 YAML 정의에 따라 HP/MP 회복 및 기타 효과(커스텀 상태 이상 등)를 적용합니다.
        * **커스텀 음식이 아닌 경우 (바닐라 음식):** 아이템의 `Material` 타입을 기준으로 `foods.yml`을 조회하여 재정의된 HP/MP 회복 및 기타 효과를 적용합니다.
        * **어디에도 정의되지 않은 경우:** HP/MP 회복 없음 (또는 설정된 기본값).
    3.  계산된 총 회복량만큼 플레이어의 `CurrentHP_Custom` 및 `CurrentMP_Custom`을 증가시킵니다 (각각의 최대치를 넘지 않도록).
    4.  음식에 `apply_custom_status_on_consume`이 정의되어 있다면, 해당 커스텀 상태 이상을 플레이어에게 부여합니다.
* **음식 섭취 쿨타임:** 별도의 `consume_cooldown_group` 시스템은 **사용하지 않습니다.** 각 음식의 `consume_duration_ticks` (섭취 시간)가 실질적인 연속 섭취 속도를 조절합니다.


## 10. RPGCore+ 커스텀 몬스터 도감 시스템  





## 11. 추가 아이디어
- 빛을 사용하는 마법사 (마인크래프트 밝기 등을 사용, 어둠과 빛을 동시에 사용) -> 메이플 루미너스 느낌  
- 월드를 여러 곳 만들고, 월드마다 난이도 및 컨셉(?)을 설정
    - 마리오마냥 특정 월드 클리어 시 다음 월드 해금  
- xp 상점  
    - 귀환주문서  
        - 개인마다 특정 월드의 특정 좌표에 스폰포인트 설정 가능. (마인크래프트 스폰포인트로 해도 될 듯)  
        - 귀환주문서 사용 시 스폰포인트로 이동  
    - 각종 음식  
    - 제작 재료  



upgrade_cost_per_level:
  2: 50000
  3: 250000
  4: 1000000
  5: 5000000